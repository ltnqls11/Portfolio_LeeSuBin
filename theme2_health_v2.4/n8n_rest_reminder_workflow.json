{
  "name": "VDT ì¦í›„êµ° ê´€ë¦¬ - íœ´ì‹ì‹œê°„ ì•Œë¦¬ë¯¸",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 25
            }
          ]
        }
      },
      "id": "cron-trigger",
      "name": "íœ´ì‹ì‹œê°„ ì•Œë¦¬ë¯¸ (25ë¶„ë§ˆë‹¤)",
      "type": "n8n-nodes-base.cron",
      "typeVersion": 1,
      "position": [
        240,
        300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "work-hours-check",
              "leftValue": "={{ $now.toFormat('HH:mm') }}",
              "rightValue": "09:00",
              "operator": {
                "type": "string",
                "operation": "gte"
              }
            },
            {
              "id": "work-hours-check-2",
              "leftValue": "={{ $now.toFormat('HH:mm') }}",
              "rightValue": "18:00",
              "operator": {
                "type": "string",
                "operation": "lte"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "work-hours-filter",
      "name": "ì—…ë¬´ì‹œê°„ í™•ì¸ (09:00-18:00)",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        460,
        300
      ]
    },
    {
      "parameters": {
        "jsCode": "// í˜„ì¬ ì‹œê°„ê³¼ ì‚¬ìš©ì ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì•Œë¦¼ ë©”ì‹œì§€ ìƒì„±\nconst now = new Date();\nconst currentHour = now.getHours();\n\n// ì˜¬ë°”ë¥¸ ì»´í“¨í„° ì‘ì—… ìì„¸ ê°€ì´ë“œ\nconst postureGuide = {\n  \"ëª¨ë‹ˆí„° ìœ„ì¹˜\": [\n    \"ğŸ‘ï¸ ëˆˆë†’ì´ì™€ ê°™ê±°ë‚˜ ì•½ê°„ ì•„ë˜\",\n    \"ğŸ“ íŒ” ê¸¸ì´ë§Œí¼ ê±°ë¦¬ ìœ ì§€ (50-70cm)\",\n    \"ğŸ–¥ï¸ í™”ë©´ ìƒë‹¨ì´ ëˆˆë†’ì´ë³´ë‹¤ ë‚®ê²Œ\"\n  ],\n  \"ì˜ì ìì„¸\": [\n    \"ğŸª‘ ë“±ë°›ì´ì— í—ˆë¦¬ë¥¼ ì™„ì „íˆ ë¶™ì´ê¸°\",\n    \"ğŸ¦¶ ë°œë°”ë‹¥ ì „ì²´ê°€ ë°”ë‹¥ì— ë‹¿ê²Œ\",\n    \"ğŸ¦µ ë¬´ë¦ ê°ë„ 90ë„ ìœ ì§€\"\n  ],\n  \"í‚¤ë³´ë“œ & ë§ˆìš°ìŠ¤\": [\n    \"âŒ¨ï¸ íŒ”ê¿ˆì¹˜ ê°ë„ 90ë„\",\n    \"âœ‹ ì†ëª©ì€ ì¼ì§ì„  ìœ ì§€\",\n    \"ğŸ’ª ì–´ê¹¨ í˜ ë¹¼ê³  ìì—°ìŠ¤ëŸ½ê²Œ\"\n  ],\n  \"ëª©ê³¼ ì–´ê¹¨\": [\n    \"ğŸ§˜ í„±ì„ ì‚´ì§ ë‹¹ê¸°ê¸°\",\n    \"ğŸ¤· ì–´ê¹¨ëŠ” ìì—°ìŠ¤ëŸ½ê²Œ ë‚´ë¦¬ê¸°\",\n    \"ğŸ¦’ ëª©ì„ ì•ìœ¼ë¡œ ë¹¼ì§€ ì•Šê¸°\"\n  ]\n};\n\n// VDT ì¦í›„êµ°ë³„ ìì„¸ êµì • íŒ\nconst postureTips = {\n  \"ê±°ë¶ëª©\": \"ğŸ¢ ëª¨ë‹ˆí„° ìƒë‹¨ì´ ëˆˆë†’ì´ì™€ ê°™ë„ë¡ ì¡°ì ˆí•˜ê³ , í„±ì„ ê°€ë³ê²Œ ë‹¹ê²¨ ëª©ì´ ì•ìœ¼ë¡œ ë‚˜ì˜¤ì§€ ì•Šê²Œ í•´ì£¼ì„¸ìš”.\",\n  \"ë¼ìš´ë“œìˆ„ë”\": \"ğŸ§˜ ê°€ìŠ´ì„ í´ê³  ì–´ê¹¨ë¥¼ ë’¤ë¡œ ì –íˆëŠ” ìŠ¤íŠ¸ë ˆì¹­ì„ í•´ì£¼ì„¸ìš”.\",\n  \"í—ˆë¦¬ë””ìŠ¤í¬\": \"ğŸª‘ ì˜ìì— ì•‰ì„ ë•ŒëŠ” í—ˆë¦¬ë¥¼ ë“±ë°›ì´ì— ë°€ì°©ì‹œí‚¤ê³ , 1ì‹œê°„ë§ˆë‹¤ ì¼ì–´ë‚˜ì„œ ê°€ë³ê²Œ ê±¸ì–´ì£¼ì„¸ìš”.\",\n  \"ì†ëª©í„°ë„ì¦í›„êµ°\": \"âœï¸ í‚¤ë³´ë“œì™€ ë§ˆìš°ìŠ¤ ì‚¬ìš© ì‹œ ì†ëª©ì´ êº¾ì´ì§€ ì•Šë„ë¡ ì¤‘ë¦½ ìœ„ì¹˜ë¥¼ ìœ ì§€í•˜ì„¸ìš”.\"\n};\n\n// ê±´ê°• íŒ (ì‹œê°„ëŒ€ë³„)\nlet healthTip = \"\";\nif (currentHour < 12) {\n  healthTip = \"ğŸŒ… ì•„ì¹¨: ì¶©ë¶„í•œ ìˆ˜ë¶„ì„ ì„­ì·¨í•˜ê³  ê°€ë²¼ìš´ ìŠ¤íŠ¸ë ˆì¹­ìœ¼ë¡œ í•˜ë£¨ë¥¼ ì‹œì‘í•˜ì„¸ìš”!\";\n} else if (currentHour < 15) {\n  healthTip = \"â˜€ï¸ ì ì‹¬: ê±´ê°•í•œ ì ì‹¬ í›„ ê°€ë²¼ìš´ ì‚°ì±…ì´ë‚˜ ìŠ¤íŠ¸ë ˆì¹­ì„ ê¶Œì¥í•©ë‹ˆë‹¤.\";\n} else {\n  healthTip = \"ğŸŒ† ì˜¤í›„: ëˆˆì˜ í”¼ë¡œë¥¼ ì¤„ì´ê¸° ìœ„í•´ 20-20-20 ë²•ì¹™ì„ ì‹¤ì²œí•˜ì„¸ìš” (20ë¶„ë§ˆë‹¤ 20í”¼íŠ¸ ê±°ë¦¬ì˜ ë¬¼ì²´ë¥¼ 20ì´ˆê°„ ë°”ë¼ë³´ê¸°).\";\n}\n\n// ë©”ì¸ ì•Œë¦¼ ë©”ì‹œì§€ ìƒì„±\nconst mainMessage = `â° íœ´ì‹ì‹œê°„ ì•Œë¦¼ (${now.toFormat('HH:mm')})\n\nğŸ’» ì¥ì‹œê°„ ì»´í“¨í„° ì‘ì—…ìœ¼ë¡œ ì¸í•œ ê±´ê°• ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤!\n\n${healthTip}\n\nğŸ” í˜„ì¬ ìì„¸ ì ê²€:\n${postureGuide[\"ëª©ê³¼ ì–´ê¹¨\"].join('\\n')}\n${postureGuide[\"ì˜ì ìì„¸\"].join('\\n')}\n\nğŸ’¡ ìì„¸ êµì • íŒ:\n${Object.values(postureTips).join('\\n')}\n\nğŸƒâ€â™‚ï¸ ê°„ë‹¨í•œ ìŠ¤íŠ¸ë ˆì¹­:\nâ€¢ ëª© ì¢Œìš° ëŒë¦¬ê¸° (10ì´ˆì”© 3íšŒ)\nâ€¢ ì–´ê¹¨ ìœ¼ì“±í•˜ê¸° (10íšŒ)\nâ€¢ ì†ëª© ëŒë¦¬ê¸° (ê° ë°©í–¥ 10íšŒ)\nâ€¢ í—ˆë¦¬ ë¹„í‹€ê¸° (ê° ë°©í–¥ 15ì´ˆ)\n\nâ±ï¸ ë‹¤ìŒ íœ´ì‹ì‹œê°„ê¹Œì§€ 25ë¶„ ë‚¨ì•˜ìŠµë‹ˆë‹¤.\n\nğŸ’ª ê±´ê°•í•œ ê°œë°œì ë˜ê¸°, ì§€ê¸ˆ ì‹œì‘í•˜ì„¸ìš”!`;\n\n// Slackìš© ë©”ì‹œì§€ (ì¤„ë°”ê¿ˆ ì²˜ë¦¬)\nconst slackMessage = mainMessage.replace(/\\n/g, '\\n');\n\n// Gmailìš© ë©”ì‹œì§€ (HTML í˜•ì‹)\nconst htmlMessage = mainMessage.replace(/\\n/g, '<br>').replace(/ğŸ’»/g, 'ğŸ’»').replace(/â°/g, 'â°');\n\nreturn [\n  {\n    json: {\n      slackMessage: slackMessage,\n      emailSubject: \"VDT ì¦í›„êµ° ê´€ë¦¬ - íœ´ì‹ì‹œê°„ ì•Œë¦¼\",\n      emailBody: mainMessage,\n      emailHtmlBody: htmlMessage,\n      currentTime: now.toFormat('yyyy-MM-dd HH:mm:ss'),\n      nextBreak: \"25ë¶„ í›„\"\n    }\n  }\n];"
      },
      "id": "message-generator",
      "name": "ì•Œë¦¼ ë©”ì‹œì§€ ìƒì„±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        680,
        300
      ]
    },
    {
      "parameters": {
        "authentication": "webhookUrl",
        "webhookUrl": "={{ $json.slack_webhook_url }}",
        "text": "={{ $json.slackMessage }}",
        "otherOptions": {
          "username": "VDT ê±´ê°• ê´€ë¦¬ ë´‡",
          "icon_emoji": ":computer:"
        }
      },
      "id": "slack-notification",
      "name": "Slack ì•Œë¦¼ ì „ì†¡",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [
        900,
        200
      ]
    },
    {
      "parameters": {
        "authentication": "oAuth2",
        "fromEmail": "={{ $json.gmail_address }}",
        "toEmail": "={{ $json.gmail_address }}",
        "subject": "={{ $json.emailSubject }}",
        "text": "={{ $json.emailBody }}",
        "html": "={{ $json.emailHtmlBody }}",
        "options": {}
      },
      "id": "gmail-notification",
      "name": "Gmail ì•Œë¦¼ ì „ì†¡",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 1,
      "position": [
        900,
        400
      ]
    },
    {
      "parameters": {
        "jsCode": "// ì•Œë¦¼ ì „ì†¡ ê²°ê³¼ ë¡œê¹…\nconst slackResult = $input.all()[0].json;\nconst gmailResult = $input.all()[1].json;\n\nconst logMessage = `\\nğŸ“Š ì•Œë¦¼ ì „ì†¡ ê²°ê³¼ (${new Date().toLocaleString('ko-KR')})\\n` +\n  `âœ… Slack: ${slackResult.success ? 'ì„±ê³µ' : 'ì‹¤íŒ¨'}\\n` +\n  `âœ… Gmail: ${gmailResult.success ? 'ì„±ê³µ' : 'ì‹¤íŒ¨'}\\n` +\n  `â° ë‹¤ìŒ ì•Œë¦¼: 25ë¶„ í›„`;\n\nconsole.log(logMessage);\n\nreturn [\n  {\n    json: {\n      timestamp: new Date().toISOString(),\n      slackStatus: slackResult.success ? 'success' : 'failed',\n      gmailStatus: gmailResult.success ? 'success' : 'failed',\n      logMessage: logMessage\n    }\n  }\n];"
      },
      "id": "notification-logger",
      "name": "ì•Œë¦¼ ì „ì†¡ ê²°ê³¼ ë¡œê¹…",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1120,
        300
      ]
    },
    {
      "parameters": {
        "jsCode": "// ì„¤ì • ì •ë³´ë¥¼ í™˜ê²½ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜¤ê¸°\nconst config = {\n  slack_webhook_url: process.env.SLACK_WEBHOOK_URL || '',\n  gmail_address: process.env.GMAIL_ADDRESS || '',\n  work_start_time: process.env.WORK_START_TIME || '09:00',\n  work_end_time: process.env.WORK_END_TIME || '18:00',\n  rest_interval: process.env.REST_INTERVAL || '25'\n};\n\n// í•„ìˆ˜ ì„¤ì • í™•ì¸\nif (!config.slack_webhook_url && !config.gmail_address) {\n  throw new Error('Slack Webhook URL ë˜ëŠ” Gmail ì£¼ì†Œ ì¤‘ í•˜ë‚˜ëŠ” ë°˜ë“œì‹œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.');\n}\n\nreturn [\n  {\n    json: config\n  }\n];"
      },
      "id": "config-loader",
      "name": "ì„¤ì • ë¡œë”",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        680,
        500
      ]
    },
    {
      "parameters": {
        "jsCode": "// ì„¤ì • ì •ë³´ë¥¼ ë©”ì‹œì§€ ìƒì„± ë…¸ë“œë¡œ ì „ë‹¬\nconst config = $input.all()[0].json;\nconst messageData = $input.all()[1].json;\n\n// ì„¤ì •ê³¼ ë©”ì‹œì§€ ë°ì´í„°ë¥¼ í•©ì¹¨\nreturn [\n  {\n    json: {\n      ...config,\n      ...messageData\n    }\n  }\n];"
      },
      "id": "data-merger",
      "name": "ë°ì´í„° ë³‘í•©",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        680,
        700
      ]
    }
  ],
  "connections": {
    "íœ´ì‹ì‹œê°„ ì•Œë¦¬ë¯¸ (25ë¶„ë§ˆë‹¤)": {
      "main": [
        [
          {
            "node": "ì—…ë¬´ì‹œê°„ í™•ì¸ (09:00-18:00)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì—…ë¬´ì‹œê°„ í™•ì¸ (09:00-18:00)": {
      "main": [
        [
          {
            "node": "ì•Œë¦¼ ë©”ì‹œì§€ ìƒì„±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì•Œë¦¼ ë©”ì‹œì§€ ìƒì„±": {
      "main": [
        [
          {
            "node": "ë°ì´í„° ë³‘í•©",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì„¤ì • ë¡œë”": {
      "main": [
        [
          {
            "node": "ë°ì´í„° ë³‘í•©",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "ë°ì´í„° ë³‘í•©": {
      "main": [
        [
          {
            "node": "Slack ì•Œë¦¼ ì „ì†¡",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Gmail ì•Œë¦¼ ì „ì†¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Slack ì•Œë¦¼ ì „ì†¡": {
      "main": [
        [
          {
            "node": "ì•Œë¦¼ ì „ì†¡ ê²°ê³¼ ë¡œê¹…",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gmail ì•Œë¦¼ ì „ì†¡": {
      "main": [
        [
          {
            "node": "ì•Œë¦¼ ì „ì†¡ ê²°ê³¼ ë¡œê¹…",
            "type": "main",
            "index": 1
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2024-01-01T00:00:00.000Z",
      "updatedAt": "2024-01-01T00:00:00.000Z",
      "id": "health-care",
      "name": "í—¬ìŠ¤ì¼€ì–´"
    },
    {
      "createdAt": "2024-01-01T00:00:00.000Z",
      "updatedAt": "2024-01-01T00:00:00.000Z",
      "id": "notification",
      "name": "ì•Œë¦¼"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2024-01-01T00:00:00.000Z",
  "versionId": "1"
}
